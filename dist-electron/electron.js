"use strict";const f=require("path"),s=require("electron");function d(t){const n=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const e in t)if(e!=="default"){const o=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(n,e,o.get?o:{enumerable:!0,get:()=>t[e]})}}return n.default=t,Object.freeze(n)}const c=d(f),{Nocturne:y}=require("@nocturne/fake-backend"),u=class{constructor(){this.nocturne=new y}getNocturneValue(t){const n=t.split(".");let e=this.nocturne;for(const o of n)e=e[o];return e}invokeNocturneFunction(t,...n){const e=t.split("."),o=e.pop();let r=this.nocturne;for(const p of e)r=r[p];return r[o](...n)}findKey(t){const n=t.split(".");let e=this.nocturne;for(const o of n)if(e=e[o],!e)throw new Error(`Key ${t} not found`);return e}listKeys(t){const n=Object.getPrototypeOf(t),e=Object.getOwnPropertyNames(t);if(n){const o=Object.getOwnPropertyNames(n);for(const r of o)u.OBJ_FIELDS.has(r)||e.push(r)}return e}buildKeys(){console.log("Build Keys");const t=[];for(const e of this.listKeys(this.nocturne))typeof e=="string"&&this.nocturne[e]&&t.push(e);const n={};for(;t.length>0;){const e=t.shift();console.log("Key:",e);const o=this.findKey(e);if(o){if(console.log("keys:",this.listKeys(o)),this.nocturne.isIgnored(e)){console.log("Ignored:",e);continue}if(typeof o=="object")for(const r of this.listKeys(o))typeof r=="string"&&t.push(`${e}.${r}`);else typeof o=="function"?n[e]="function":n[e]="value"}}return console.log("Keys:",JSON.stringify(n)),JSON.stringify(n)}};let a=u;a.OBJ_FIELDS=new Set(Object.getOwnPropertyNames(Object.prototype));const i=new a;function l(){const t=new s.BrowserWindow({width:800,height:600,webPreferences:{preload:c.join(__dirname,"preload.js"),nodeIntegration:!0}});s.ipcMain.handle("getNocturneValue",(n,e)=>i.getNocturneValue(e)),s.ipcMain.handle("invokeNocturneFunction",(n,e,...o)=>i.invokeNocturneFunction(e,...o)),s.ipcMain.handle("buildKeys",()=>i.buildKeys()),t.loadURL(process.env.VITE_DEV_SERVER_URL?process.env.VITE_DEV_SERVER_URL:`file://${c.join(__dirname,"../dist/index.html")}`)}s.app.whenReady().then(()=>{l(),s.app.on("activate",function(){s.BrowserWindow.getAllWindows().length===0&&l()})});s.app.on("window-all-closed",()=>{process.platform!=="darwin"&&s.app.quit()});
